<!DOCTYPE html>
<HTML xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"
      xmlns:svg="http://www.w3.org/2000/svg"
      xmlns:xlink="http://www.w3.org/1999/xlink">
  <HEAD>
    <TITLE>Sudoku Font</TITLE>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <SCRIPT TYPE="text/javascript" src="node_modules/@svgdotjs/svg.js/dist/svg.min.js"></SCRIPT>
    <SCRIPT TYPE="text/javascript" src="node_modules/furls/furls.js"></SCRIPT>
    <SCRIPT TYPE="text/javascript" src="fontGen.js"></SCRIPT>
    <SCRIPT TYPE="text/javascript" src="sudoku.js"></SCRIPT>
    <link href="https://fonts.googleapis.com/css?family=Libre+Franklin:700&display=swap" rel="stylesheet">
    <STYLE TYPE="text/css">
      #warnings { background: red; color: yellow; padding: 1ex; display: none; }
      @media print {
        .noprint { display: none; }
      }
      TEXTAREA { vertical-align: middle; }

      TD { vertical-align: top; }

      #hud { display: none; }

      .hud-false > body > *:not(#output) { display: none; }

      /* NYTimes uses #959595 for inner lines, nyt-franklin for font */

      /* These widths must match minorWidth and majorWidth in sudoku.coffee */
      svg .grid line { stroke-width: 0.05; stroke: #666; stroke-linecap: square; }
      svg .grid line.major { stroke-width: 0.15; }
      svg .grid line.border { stroke-width: 0.15; stroke: black; }

      svg .numbers text { text-anchor: middle; font-family: 'Libre Franklin', sans-serif; font-weight: 700; font-size: 0.6px; cursor: default; }
      /* bolder puzzle numbers: svg .numbers text.puzzle { font-weight: 700; }*/
      :root.mode-puzzle.mistakes-true svg .numbers text.invalid { fill: hsl(0,100%,40%); stroke: hsl(0,100%,60%); stroke-width: 0.02; } /* cf. NYTimes #ff4b56 */

      svg .edges line { stroke-width: 0.333; stroke: #cac; stroke-linecap: round; }
      :root.path-true:not(.puzzle) svg .edges line.path,
      :root.path-true svg.solved .edges line.path { stroke-width: 0.666; stroke: #b8b; }
      :root.mode-puzzle .edges.solved { visibility: hidden; }
      :root:not(.mode-puzzle) .edges.user { visibility: hidden; }

      svg .squares rect.puzzle { fill: #ddd; }
      svg .squares rect { fill: white; }
      :root.hints-true.mode-puzzle svg .squares rect.hint { fill: hsl(140,70%,85%); }
      :root.mode-puzzle svg .squares rect:not(.puzzle):hover { fill: hsl(50,100%,80%); }
      :root.mode-puzzle svg .squares rect:not(.puzzle).selected { fill: hsl(50,100%,50%); } /* based on #ffda00 from NYTimes */
      :root.mode-puzzle svg .squares rect:not(.puzzle), :root.mode-puzzle svg .numbers text:not(.puzzle) { cursor: pointer; }

      :root.edges-false svg .edges line:not(.base) { visibility: hidden; }
      :root.edges-false.path-false svg .edges line.base { visibility: hidden; }
      :root.mode-puzzle svg .numbers text.solution { visibility: hidden; }
      :root:not(.mode-puzzle) svg .numbers text.user { visibility: hidden; }

      svg .target { fill: purple; }
      svg .target:hover { cursor: pointer; }
      svg { user-select: none; }

      :root.mode-puzzle svg.solved { outline: solid gold 3px; } /* gold = hsl(52,89%,55%) */
      :root.mode-puzzle svg.solved .grid line:not(.border) { stroke: hsl(52,30%,40%); }
      :root.mode-puzzle svg.solved .squares rect { fill: hsl(52,89%,98%); }
      :root.mode-puzzle svg.solved .squares rect.mode-puzzle { fill: hsl(52,30%,87%); }

      #numbers { position: fixed; top: 0; left: 0; right: 0; text-align: center; }
      #numbers div { display: inline-block; border: solid;
        min-width: 25px; min-height: 25px; padding: 2px; text-align: center;
        font-family: 'Libre Franklin', sans-serif; font-weight: 700; font-size: 20px;
        background: #ddd; cursor: pointer;
      }
      #numbers div:hover { background: hsl(50,100%,80%); }

/* from http://danielstern.ca/range.css/ */
input[type=range] {
  -webkit-appearance: none;
  width: 100%;
  margin: 5px 0;
}
input[type=range]:focus {
  outline: none;
}
input[type=range]::-webkit-slider-runnable-track {
  width: 100%;
  height: 5px;
  cursor: pointer;
  box-shadow: 1px 1px 1px #000000, 0px 0px 1px #0d0d0d;
  background: #c8c8c8;
  border-radius: 1px;
  border: 0.2px solid #010101;
}
input[type=range]::-webkit-slider-thumb {
  box-shadow: 0.9px 0.9px 1px #000031, 0px 0px 0.9px #00004b;
  border: 1px solid #00001e;
  height: 15px;
  width: 15px;
  border-radius: 15px;
  background: #80c4ff;
  cursor: pointer;
  -webkit-appearance: none;
  margin-top: -5.2px;
}
input[type=range]:focus::-webkit-slider-runnable-track {
  background: #e2e2e2;
}
input[type=range]::-moz-range-track {
  width: 100%;
  height: 5px;
  cursor: pointer;
  box-shadow: 1px 1px 1px #000000, 0px 0px 1px #0d0d0d;
  background: #c8c8c8;
  border-radius: 1px;
  border: 0.2px solid #010101;
}
input[type=range]::-moz-range-thumb {
  box-shadow: 0.9px 0.9px 1px #000031, 0px 0px 0.9px #00004b;
  border: 1px solid #00001e;
  height: 15px;
  width: 15px;
  border-radius: 15px;
  background: #80c4ff;
  cursor: pointer;
}
input[type=range]::-ms-track {
  width: 100%;
  height: 5px;
  cursor: pointer;
  background: transparent;
  border-color: transparent;
  color: transparent;
}
input[type=range]::-ms-fill-lower {
  background: #afafaf;
  border: 0.2px solid #010101;
  border-radius: 2px;
  box-shadow: 1px 1px 1px #000000, 0px 0px 1px #0d0d0d;
}
input[type=range]::-ms-fill-upper {
  background: #c8c8c8;
  border: 0.2px solid #010101;
  border-radius: 2px;
  box-shadow: 1px 1px 1px #000000, 0px 0px 1px #0d0d0d;
}
input[type=range]::-ms-thumb {
  box-shadow: 0.9px 0.9px 1px #000031, 0px 0px 0.9px #00004b;
  border: 1px solid #00001e;
  height: 15px;
  width: 15px;
  border-radius: 15px;
  background: #80c4ff;
  cursor: pointer;
  height: 5px;
}
input[type=range]:focus::-ms-fill-lower {
  background: #c8c8c8;
}
input[type=range]:focus::-ms-fill-upper {
  background: #e2e2e2;
}

    </STYLE>
    <STYLE TYPE="text/css" ID="svgSize">
      svg { width: 250px; }
      .word + .word { margin-left: 100px; }
    </STYLE>
    <!--#include virtual="../../analytics.html"-->
  </HEAD>
  <BODY>
    <DIV ID="numbers">
      <DIV ID="number1">1</DIV>
      <DIV ID="number2">2</DIV>
      <DIV ID="number3">3</DIV>
      <DIV ID="number4">4</DIV>
      <DIV ID="number5">5</DIV>
      <DIV ID="number6">6</DIV>
      <DIV ID="number7">7</DIV>
      <DIV ID="number8">8</DIV>
      <DIV ID="number9">9</DIV>
      <DIV ID="number0">erase</DIV>
    </DIV>

    <TABLE WIDTH="100%">
      <TR>
        <TD STYLE="text-align: left; vertical-align: middle;">
          <H1>Sudoku Font</H1>
        <TD STYLE="text-align: right; vertical-align: middle;">
          <H2>by <A HREF="http://erikdemaine.org/">Erik&nbsp;Demaine</A> and <A HREF="http://martindemaine.org">Martin&nbsp;Demaine</A>, 2021</H2>
    </TABLE>

    <TABLE WIDTH="100%" CLASS="noprint">
      <TR>
        <TD>
          <LABEL FOR="text">Enter text to render:</LABEL> &nbsp;
          <TEXTAREA NAME="text" ID="text" ROWS=4 COLS=40>text</TEXTAREA>
        </TD>
        <TD>
          <INPUT TYPE="radio" CHECKED NAME="mode" VALUE="anim" ID="animMode"><LABEL FOR="animMode">Animation</LABEL>
          <BR>
          <INPUT TYPE="radio" NAME="mode" VALUE="solved" ID="solvedMode"><LABEL FOR="solvedMode">Solved</LABEL>
          <BR>
          <INPUT TYPE="radio" NAME="mode" VALUE="puzzle" ID="puzzleMode"><LABEL FOR="puzzleMode">Puzzle</LABEL>
          <P>
          <BUTTON ID="randomize">Randomize</BUTTON>
        </TD>
        <TD>
          <INPUT TYPE="checkbox" CHECKED ID="edges"><LABEL FOR="edges">Consecutive edges</LABEL>
          <BR>
          <INPUT TYPE="checkbox" CHECKED ID="path"><LABEL FOR="path">Longest path</LABEL>
          <BR>
          <INPUT TYPE="checkbox" CHECKED ID="mistakes"><LABEL FOR="mistakes">Mistakes</LABEL>
          <BR>
          <INPUT TYPE="checkbox" ID="hints"><LABEL FOR="hints">Hints</LABEL>
          <BR>
          <INPUT ID="hud" TYPE="checkbox" CHECKED>
          <SCRIPT>
            if (/[?&]hud=0/.test(window.location.search)) // avoid blinking
              document.documentElement.classList.add('hud-false');
          </SCRIPT>
        </TD>
    </TABLE>

    <INPUT CLASS="noprint" TYPE="range" ID="size" MIN="16" MAX="800" VALUE="250" STYLE="width: 100%" TITLE="Size of characters">

    <P>

    <DIV id="output" STYLE="width: 100%">
    </DIV>

    <DIV STYLE="text-align: right" CLASS="noprint">
      <BUTTON ID="nohud" TITLE="Use browser back button to restore interface.">Hide all but font rendering</BUTTON>
    </DIV>

    <HR>

    <P>
    <B><a href="https://en.wikipedia.org/wiki/Sudoku">Sudoku</a></B>
    or Number Place is among the most famous pencil-and-paper puzzles,
    <a href="https://trends.google.com/trends/explore?date=all&q=%2Fm%2F04x1d_,%2Fm%2F0j4mv">rising in popularity in 2005</a>
    to rival even crossword puzzles,
    with <a href="https://www.nytimes.com/puzzles/sudoku/">daily puzzles in the New York Times</a>.
    Its standard form consists of a 9&nbsp;&times;&nbsp;9 grid
    decomposed into 3&nbsp;&times;&nbsp;3 subgrids that are each
    3&nbsp;&times;&nbsp;3.  A puzzle has some cells pre-filled with
    numbers between 1 and 9; the goal is to fill in the remaining cells
    such that every row, column, and 3&nbsp;&times;&nbsp;3 subgrid
    has every number between 1 and 9 (each exactly once).

    <P>
    <B>Fonts.</B>
    In this typeface, each letter is represented by a standard Sudoku
    puzzle whose unique solution &ldquo;draws the letter&rdquo; in the
    following sense: if you connect together edge-adjacent squares having
    <b>consecutive numbers</b> (1 to 2, 2 to 3, &hellip;, 8 to 9), then the
    <b>longest path</b> through these connections draws the letter shape.
    Consecutive numbers are easy for the puzzle solver to keep track of,
    and somewhat controllable by the puzzle designer, but it also seems
    impossible to avoid spurious consecutive-number connections;
    the longest path allows us to clean out these spurious connections.
    (<a href="https://archive.bridgesmathart.org/2011/bridges2011-187.pdf">Inglis and Kaplan</a> considered other approaches to designing Sudoku puzzles whose solution generate images.)

    <P>
    In the <b>Solved</b> font, you can see the completely solved puzzle,
    which is nice for visualizing the font.  But more fun is
    the <b>Puzzle</b> font, where you just see enough numbers to uniquely
    determine the solution, and you need to solve the puzzle to figure out
    the hidden letter.  You can interactively solve the puzzle by clicking
    on a square and either typing the number you want to fill (1 through 9
    or 0/delete/backspace to erase),
    or clicking on the desired action at the top of the screen.
    You can also use arrow keys (or vi's hjkl) to move around squares.
    For each letter, we have designed 81 (=&nbsp;9<sup>2</sup>) different
    puzzles that solve to the same longest path, and they are chosen at
    random, so even repeated letters in a message offer distinct puzzles
    and no shortcuts for recognizing duplicates.  (If you want to change
    the random selections made for all letters, click the <b>Randomize</b>
    button.)
    &bull;
    If you make a mistake (duplicate numbers in the same
    row/column/subgrid), their text will turn red (unless you turn off
    <b>Mistakes</b> visualization).
    &bull;
    If you're stuck, you can turn on <b>Hints</b> visualization,
    which will highlight squares (in green) that currently have only
    one way to fill them in.  (This makes the puzzles quite easy.)
    &bull;
    You can also turn on or off <b>Consecutive edges</b>
    (among the grid filled in so far) and the <b>Longest path</b> through
    these edges (which, in puzzle mode, shows only when you solve the
    entire puzzle).

    <P>
    <B>Related mathematics.</B>
    Generalized to an
    <i>n</i><sup>2</sup>&nbsp;&times;&nbsp;<i>n</i><sup>2</sup> grid
    with <i>n</i>&nbsp;&times;&nbsp;<i>n</i> subgrids,
    Sudoku is <b>NP-complete</b>, and even stronger,
    <b><a href="http://www-imai.is.s.u-tokyo.ac.jp/~yato/data2/SIGAL87-2.pdf">ASP-complete</a></b>.
    This result means that it is computationally intractable to determine
    whether a puzzle has a solution, and furthermore, whether it has
    another solution even if we are given one or more solutions.
    (The latter question is important for puzzle design, to guarantee a
     unique solution.)
    Even once you solve the Sudoku puzzles,
    <a href="https://en.wikipedia.org/wiki/Longest_path_problem">finding the longest path</a> is also NP-complete,
    <a href="https://arxiv.org/abs/1706.10046">even in grids</a>.

    <P>
    Most real-world Sudoku puzzles (including those in this typeface)
    are designed in such a way to guarantee unique solvability.
    The general approach is to start with a solved puzzle, then repeatedly
    remove clues that can be uniquely determined by the remaining clues,
    using one or more techniques/strategies/rules
    (<a href="https://www.sudokudragon.com/sudokustrategy.htm">see</a>
    <a href="https://www.conceptispuzzles.com/index.aspx?uri=puzzle/sudoku/techniques">variation</a>
    <a href="https://www.kristanix.com/sudokuepic/sudoku-solving-techniques.php">descriptions</a>).
    In this typeface, we just use the simplest (depth-1) rule:
    if a square can be filled in by only one number that does not
    duplicate another number in the same row, column, or subgrid,
    then fill it in.
    
    <P>
    <B>Genesis.</B>
    This typeface design started shortly after Erik taught
    <a href="https://py.mit.edu/_static/fall19/lectures/lecture04/lecture4.zip">a lecture</a>
    in MIT's Fundamentals of Programming class (<a href="https://py.mit.edu/fall19">6.009</a>)
    and realized how easy it is to write a brute-force Sudoku solver.
    We designed the longest paths by hand, and used a solver to randomly
    fill in the remaining squares (going back to the hand-drawing board
    if no completion was possible), and then randomly removing clues that
    could be filled back in by the simplest no-duplicates rule described
    above.
    We also prioritized the solver to avoid adding any extra consecutive
    edges off the intended longest, when possible.  In two letters
    (N and Q), this extra goal is impossible, so we just constrained the
    longest path to not change.
    (These computations take a while, so we precomputed them.)

    <P>
    Check out <A HREF="http://erikdemaine.org/fonts/">other mathematical and
    puzzle fonts</A>. &bull; Feedback or not working?
    <A HREF="mailto:edemaine+fonts@mit.edu">Email Erik</A>.
  </BODY>
</HTML>
